// button: View Highscores
// text: Time

// Multiple Choice Quiz
// array of pre-loaded questions
// createElement: ol to display quiz question text, created in the body
// appendChild: append li to ol for the multiple choice answers
// textContent: fill both ol and li with text content and make sure they're related

//after the question has been answered, remove current question then populate a new question

// list of all questions, choices, and answers
var questions = [
    {
      question: 'Commonly used data types DO NOT include:',
      choices: ['strings', 'booleans', 'alerts', 'numbers'],
      answer: 'alerts',
    },
    {
      question: 'The condition in an if / else statement is enclosed within ____.',
      choices: ['quotes', 'curly brackets', 'parentheses', 'square brackets'],
      answer: 'parentheses',
    },
    {
      question: 'Arrays in JavaScript can be used to store ____.',
      choices: [
        'numbers and strings',
        'other arrays',
        'booleans',
        'all of the above',
      ],
      answer: 'all of the above',
    },
    {
      question:
        'String values must be enclosed within ____ when being assigned to variables.',
      choices: ['commas', 'curly brackets', 'quotes', 'parentheses'],
      answer: 'quotes',
    },
    {
      question:
        'A very useful tool used during development and debugging for printing content to the debugger is:',
      choices: ['JavaScript', 'terminal / bash', 'for loops', 'console.log'],
      answer: 'console.log',
    },
  ];


function initializeQuestions() {
  var tempArr = [];
  for (var i = 0; i < questions.length; i++){
      tempArr.push(questions[i]);
  }
  return tempArr;
}
  //keep track of the player's score
  //we will need to store this on local storage?
var scoreboard = {
    correct: -1,
    incorrect: -1
} 

//array of high scores generated by stored local data
var highscores = [];
var remainingQuestions = initializeQuestions();
var randNum = -1;

  
//creates an ol element and its children li elements
function generateQuestion(num){
    var questionEl = document.createElement('h1');
    var section = document.getElementById('quiz');
    var questionText = questions[num].question; //this is where num goes

    questionEl.setAttribute('id', 'question')
    section.appendChild(questionEl);
    questionEl.textContent = questionText;
}

function generateAnswers(num){
    var choicesEl = []; //array of elements to be put onto the page
    var section = document.getElementById('question');
    var choicesText = remainingQuestions[num].choices; //pulls the array of choices from the questions object and assigns it to the new choicesText variable
    var randomChoice = 0;
    var maxIterations = choicesText.length;

    for(var i = 0; i < maxIterations; i++){
        choicesEl.push(document.createElement('button'));
        choicesEl[i].setAttribute('type', 'button');
        choicesEl[i].setAttribute('id', 'answer-' + [i]);
        randomChoice = randomNumber(choicesText.length);
        choicesEl[i].textContent = choicesText[randomChoice];
        choicesText.splice(randomChoice, 1);
        section.appendChild(choicesEl[i]);
        console.log(choicesEl[i]);
    }
}


function randomNumber(num){
    if(!(num < 0)){
        return Math.floor(Math.random() * num);
    } else { console.log('ERROR HERE?') }
}

//what is to be displayed to the user before the game starts
function preGame(){
  var timeCount = 1000;
  var section = document.getElementById('quiz');
  var button = document.createElement('button');
  button.setAttribute('type', 'button');
  button.setAttribute('id', 'start-button');
  button.textContent = "Start Quiz!";
  section.appendChild(button);

  button.addEventListener('click', function(){ 
    button.remove();
    game(timeCount); 
  });
  
}

function myEvents(){
  //check answer selection
document.getElementById('answer-0').addEventListener('click', checkAnswer => {
  console.log("Answer 0");
  var answer0 = document.getElementById('answer-0').textContent;
  // console.log(answer0);
  // console.log(remainingQuestions[randNum].answer);
  if(answer0 == remainingQuestions[randNum].answer){ 
    console.log("A0");
    remainingQuestions.splice(randNum, 1);
    randNum = randomNumber(remainingQuestions.length);
    document.getElementById('answer-0').remove();
    document.getElementById('answer-1').remove();
    document.getElementById('answer-2').remove();
    document.getElementById('answer-3').remove();
    document.getElementById('question').remove();
    generateQuestion(randNum);
    generateAnswers(randNum);
    myEvents();
  }
})

document.getElementById('answer-1').addEventListener('click', checkAnswer => {
  console.log("Answer 1");
  var answer1 = document.getElementById('answer-1').textContent;
  if(answer1 == remainingQuestions[randNum].answer){ 
    console.log("A1");
    remainingQuestions.splice(randNum, 1);
    randNum = randomNumber(remainingQuestions.length);
    document.getElementById('answer-0').remove();
    document.getElementById('answer-1').remove();
    document.getElementById('answer-2').remove();
    document.getElementById('answer-3').remove();
    document.getElementById('question').remove();
    generateQuestion(randNum);
    generateAnswers(randNum);
    myEvents();
  }    
})

document.getElementById('answer-2').addEventListener('click', checkAnswer => {
  console.log("Answer 2");
  var answer2 = document.getElementById('answer-2').textContent;
  if(answer2 == remainingQuestions[randNum].answer){ 
    console.log("A2");
    remainingQuestions.splice(randNum, 1);
    randNum = randomNumber(remainingQuestions.length);
    document.getElementById('answer-0').remove();
    document.getElementById('answer-1').remove();
    document.getElementById('answer-2').remove();
    document.getElementById('answer-3').remove();
    document.getElementById('question').remove();
    generateQuestion(randNum);
    generateAnswers(randNum);
    myEvents();
  }    
})

document.getElementById('answer-3').addEventListener('click', checkAnswer => {
  console.log("Answer 3");
  var answer3 = document.getElementById('answer-3').textContent;
  if(answer3 == remainingQuestions[randNum].answer){ 
    console.log("A3");
    remainingQuestions.splice(randNum, 1);
    randNum = randomNumber(remainingQuestions.length);
    document.getElementById('answer-0').remove();
    document.getElementById('answer-1').remove();
    document.getElementById('answer-2').remove();
    document.getElementById('answer-3').remove();
    document.getElementById('question').remove();
    generateQuestion(randNum);
    generateAnswers(randNum);
    myEvents();
  }    
})
}

//starts the page
preGame();

//FIRST the screen will be populated with the question and answers
//SECOND the timer will start immediately after first
//the timer function will be triggered with a start button press
function game(timeCount){
  //create timer in header
  var sectionHeader = document.getElementById('header');
  var headerTimer = document.createElement('h1');
  headerTimer.setAttribute('id', 'timer');
  headerTimer.textContent = "Time Remaining: " + timeCount;
  sectionHeader.prepend(headerTimer);

  //create high scores button in header
  // var headerHighscores = document.createElement('button');
  // headerHighscores.setAttribute('type', 'button');
  // headerHighscores.textContent = "Highscores";
  // sectionHeader.appendChild(headerHighscores);

  var countdown = setInterval(timer => {
    if(timeCount <= 0){
        postGame();
        clearInterval(countdown);
    } else {
        timeCount--;
        document.getElementById('timer').textContent = "Time Remaining: " + timeCount;
    }
  }, 1000);

  randNum = randomNumber(remainingQuestions.length);
  
  generateQuestion(randNum);
  generateAnswers(randNum);  
  myEvents();
}

//game over message that displays the score the user got
function postGame(){
  var headerTimer = document.getElementById('timer');
  var question = document.getElementById('question');
  var section = document.getElementById('quiz');
  var replay = document.createElement('button');
  replay.setAttribute('type', 'button');
  replay.setAttribute('id', 'replay');
  replay.textContent = "Play Again?";
  section.appendChild(replay);

  
  headerTimer.remove();
  question.remove();

  replay.addEventListener('click', playAgain => {
    replay.remove();
    preGame();
  });
}




